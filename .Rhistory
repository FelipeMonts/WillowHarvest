Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2013", c("Z1")]<-1 ;
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2013", c("Z2")]<-0 ;
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2013", c("F.SURVEY.YEAR","Z1" , "Z2")]
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2014", c("Z1")]<-0 ;
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2013", c("Z2")]<-1 ;
#  For three different cathegories, two dummy variables are needed to differentiate between them; [z1, z2] where z1={1, 0, 0} and z2={0, 1, 0}
#  See Draper and Smith, 1998. Applied Regression Analysis
#
Paper.data.Plots$Z1<-Paper.data.Plots$Z2<-0 ;
# Dummy variables for survey year 2013 = {z1=1, z2=0}
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2013", c("Z1")]<-1 ;
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2013", c("Z2")]<-0 ;
# Dummy variables for survey year 2014 = {z1=0, z2=1}
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2014", c("Z1")]<-0 ;
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2014", c("Z2")]<-1 ;
# Dummy variables for survey year 2015 = {z1=0, z2=0}
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2015", c("Z1","Z2")]<-0 ;
View(Paper.data.Plots)
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2013", c("F.SURVEY.YEAR","Z1" , "Z2")]
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2014", c("F.SURVEY.YEAR","Z1" , "Z2")]
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2015", c("F.SURVEY.YEAR","Z1" , "Z2")]
str(Paper.data.Plots)
levels(Paper.data.Plots$F.SURVEY.YEAR)
Paper.data.Plots$Z1<-Paper.data.Plots$Z2<-0 ;
# Dummy variables for survey year 2013 = {z1=1, z2=0}
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2013", c("Z1")]<-1 ;
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2013", c("Z2")]<-0 ;
# Dummy variables for survey year 2014 = {z1=0, z2=1}
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2014", c("Z1")]<-0 ;
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2014", c("Z2")]<-1 ;
# Dummy variables for survey year 2015 = {z1=0, z2=0}
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2016", c("Z1","Z2")]<-0 ;
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2013", c("F.SURVEY.YEAR","Z1" , "Z2")]
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2014", c("F.SURVEY.YEAR","Z1" , "Z2")]
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2016", c("F.SURVEY.YEAR","Z1" , "Z2")]
str(Paper.data.Plots)
AnalysisHArvest.Plot.T2<-lm(MEAN_DRY.Mg.Ha.Year ~ Z1 + Z2 + MEAN_PLANT.DENSITY.pl.ha + F.HARVEST.YEAR * F.VARIETY , data=Paper.data.Plots);
AnalysisHArvest.Plot.T2<-lm(MEAN_DRY.Mg.Ha.Year ~ Z1 + Z2 + MEAN_PLANT.DENSITY.pl.ha + F.HARVEST.YEAR * F.VARIETY , data=Paper.data.Plots);
summary(AnalysisHArvest.Plot.T2)
AnalysisHArvest.Plot.T2<-lm(MEAN_DRY.Mg.Ha.Year ~ Z1 + Z2 + ( F.HARVEST.YEAR * F.VARIETY * MEAN_PLANT.DENSITY.pl.ha) , data=Paper.data.Plots);
summary(AnalysisHArvest.Plot.T2)
anova(AnalysisHArvest.Plot.T2, test="F")
T2<-tidy(anova(AnalysisHArvest.Plot.T2, test="F"))
tidy(anova(AnalysisHArvest.Plot.T2, test="F"))
###############################################################################################################
#                           Analysis using lm
###############################################################################################################
#   str(Paper.data.Plots) ;View(Paper.data.Plots)
Paper.data.Plots[which(Paper.data.Plots$F.SURVEY.YEAR==2014),]
AnalysisHArvest.Plot<-lm(MEAN_DRY.Mg.Ha.Year ~ F.HARVEST.YEAR * F.BLOCK * F.VARIETY  , data=Paper.data.Plots[which(Paper.data.Plots$F.SURVEY.YEAR==2014),]); ### Overfitted
AnalysisHArvest.Plot.TS1<-lm(MEAN_DRY.Mg.Ha.Year ~ F.HARVEST.YEAR * (F.BLOCK + F.VARIETY)  , data=Paper.data.Plots[which(Paper.data.Plots$F.SURVEY.YEAR==2014),]); ### Table S1
summary(AnalysisHArvest.Plot.TS1)
anova(AnalysisHArvest.Plot.TS1, test="F")
TS1<-tidy(anova(AnalysisHArvest.Plot.TS1, test="F"))
TS1.coeff<-tidy(AnalysisHArvest.Plot.TS1)
AnalysisHArvest.Plot.T1<-lm(MEAN_DRY.Mg.Ha.Year ~ F.HARVEST.YEAR * F.VARIETY  , data=Paper.data.Plots[which(Paper.data.Plots$F.SURVEY.YEAR==2014),]);### Table 1
summary(AnalysisHArvest.Plot.T1)
anova(AnalysisHArvest.Plot.T1, test="F")
T1<-tidy(anova(AnalysisHArvest.Plot.T1, test="F"))
T1.coeff<-tidy(AnalysisHArvest.Plot.T1)
###############################################################################################################
#                           Analysis using lm  and adding a dummy variable to include the survey year
###############################################################################################################
# View(Paper.data.Plots)  ;  str(Paper.data.Plots)
#  For three different cathegories, two dummy variables are needed to differentiate between them; [z1, z2] where z1={1, 0, 0} and z2={0, 1, 0}
#  See Draper and Smith, 1998. Applied Regression Analysis
#
Paper.data.Plots$Z1<-Paper.data.Plots$Z2<-0 ;
# Dummy variables for survey year 2013 = {z1=1, z2=0}
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2013", c("Z1")]<-1 ;
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2013", c("Z2")]<-0 ;
# Dummy variables for survey year 2014 = {z1=0, z2=1}
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2014", c("Z1")]<-0 ;
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2014", c("Z2")]<-1 ;
# Dummy variables for survey year 2015 = {z1=0, z2=0}
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2016", c("Z1","Z2")]<-0 ;
### Analysis with lm with survey year and the dummy variables z1 z2
AnalysisHArvest.Plot.T2<-lm(MEAN_DRY.Mg.Ha.Year ~ Z1 + Z2 + ( F.HARVEST.YEAR * F.VARIETY * MEAN_PLANT.DENSITY.pl.ha) , data=Paper.data.Plots);
summary(AnalysisHArvest.Plot.T2)
anova(AnalysisHArvest.Plot.T2, test="F")
T2<-tidy(anova(AnalysisHArvest.Plot.T2, test="F"))
T2.coeff<-tidy(AnalysisHArvest.Plot.T2)
effects(AnalysisHArvest.Plot)
plot(AnalysisHArvest.Plot)
###############################################################################################################
#                           Print the data in an excel workbook Tables.xlsx
###############################################################################################################
Willow.Harvest.Tables.wb<-createWorkbook() ;
#### Table_S1
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_S1') ;
writeDataTable(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1.coeff, startRow= dim(TS1)[1]+10) ;
#### Table_1
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_1') ;
writeDataTable(Willow.Harvest.Tables.wb, sheet='Table_1',x= T1) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_1',x= T1.coeff, startRow= dim(T1)[1]+10) ;
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_2') ;
writeDataTable(Willow.Harvest.Tables.wb, sheet='Table_2',x= T2) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_2',x= T2.coeff, startRow= dim(T2)[1]+10) ;
saveWorkbook(Willow.Harvest.Tables.wb, file=paste0('../Tables', '.xlsx'), overwrite = T ) ;
saveWorkbook(Willow.Harvest.Tables.wb, file=paste0('../Tables', '.xlsx'), overwrite = T ) ;
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',]
AnalysisHArvest.Plot.T3<-lm(MEAN_DRY.Mg.Ha.Year ~ F.HARVEST.YEAR * F.VARIETY * MEAN_PLANT.DENSITY.pl.ha , data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',]);
summary(AnalysisHArvest.Plot.T3)
AnalysisHArvest.Plot.T3<-lm(MEAN_DRY.Mg.Ha.Year ~  MEAN_PLANT.DENSITY.pl.ha + (F.HARVEST.YEAR * F.VARIETY) , data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',]);
summary(AnalysisHArvest.Plot.T3)
AnalysisHArvest.Plot.T3<-lm(MEAN_DRY.Mg.Ha.Year ~  MEAN_PLANT.DENSITY.pl.ha + (F.HARVEST.YEAR * F.VARIETY) + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY, data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',]);
summary(AnalysisHArvest.Plot.T3)
names(TS1)
Willow.Harvest.Tables.wb<-createWorkbook() ;
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_S1') ;
writeDataTable(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1, tableStyle = 'none') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1.coeff, startRow= dim(TS1)[1]+10) ;
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_1') ;
writeDataTable(Willow.Harvest.Tables.wb, sheet='Table_1',x= T1) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_1',x= T1.coeff, startRow= dim(T1)[1]+10) ;
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_2') ;
writeDataTable(Willow.Harvest.Tables.wb, sheet='Table_2',x= T2) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_2',x= T2.coeff, startRow= dim(T2)[1]+10) ;
saveWorkbook(Willow.Harvest.Tables.wb, file=paste0('../Tables', '.xlsx'), overwrite = T ) ;
AnalysisHArvest.Plot<-nlme::gls(MEAN_DRY.Mg.Ha.Year ~ F.HARVEST.YEAR * F.BLOCK * F.VARIETY  , data=Paper.data.Plots[which(Paper.data.Plots$F.SURVEY.YEAR==2014),]); ### Overfitted
Willow.Harvest.Tables.wb<-createWorkbook() ;
## Set excel table formatting parameters
#header style
hs1 <- createStyle(halign = "CENTER", textDecoration = "Bold",border = "Bottom", fontColour = "BLACK")
options("openxlsx.borderStyle" = "thin")
options("openxlsx.borderColour" = "BLACK")
options("openxlsx.headerStyle" = hs1)
options("openxlsx.withFilter" = F)
hs1<-createStyle(halign = "CENTER", textDecoration = "Bold",border = "Bottom", fontColour = "black")
options("openxlsx.borderColour" = "black")
Willow.Harvest.Tables.wb<-createWorkbook() ;
## Set excel table formatting parameters
#header style
hs1<-createStyle(halign = "CENTER", textDecoration = "Bold",border = "Bottom", fontColour = "black")
options("openxlsx.borderStyle" = "thin")
options("openxlsx.borderColour" = "black")
options("openxlsx.headerStyle" = hs1)
options("openxlsx.withFilter" = F)
#### Table_S1
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_S1') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1, ) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1.coeff, startRow= dim(TS1)[1]+10) ;
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_1') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_1',x= T1) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_1',x= T1.coeff, startRow= dim(T1)[1]+10) ;
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_2') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_2',x= T2) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_2',x= T2.coeff, startRow= dim(T2)[1]+10) ;
saveWorkbook(Willow.Harvest.Tables.wb, file=paste0('../Tables', '.xlsx'), overwrite = T ) ;
hs1<-createStyle(halign = "CENTER", textDecoration = "Bold",border = "Bottom", fontColour = "black")
hs1<-createStyle(halign = "CENTER", textDecoration = "Bold", border = "Bottom", fontColour = "black")
options("openxlsx.borderStyle" = "thin")
options("openxlsx.borderColour" = "black")
options("openxlsx.headerStyle" = hs1)
options("openxlsx.withFilter" = F)
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_S1') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1, ) ;
hs1<-createStyle(halign = "CENTER", textDecoration = "Bold", border = "Bottom", fontColour = "black")
options("openxlsx.borderStyle" = "thin")
options("openxlsx.borderColour" = "black")
options("openxlsx.headerStyle" = hs1)
options("openxlsx.withFilter" = F)
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_S1') ;
Willow.Harvest.Tables.wb<-createWorkbook() ;
## Set excel table formatting parameters
#header style
hs1<-createStyle(halign = "CENTER", textDecoration = "Bold", border = "Bottom", fontColour = "black")
options("openxlsx.borderStyle" = "thin")
options("openxlsx.borderColour" = "black")
options("openxlsx.headerStyle" = hs1)
options("openxlsx.withFilter" = F)
#### Table_S1
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_S1') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1, ) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1.coeff, startRow= dim(TS1)[1]+10) ;
#### Table_1
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_1') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_1',x= T1) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_1',x= T1.coeff, startRow= dim(T1)[1]+10) ;
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_2') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_2',x= T2) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_2',x= T2.coeff, startRow= dim(T2)[1]+10) ;
saveWorkbook(Willow.Harvest.Tables.wb, file=paste0('../Tables', '.xlsx'), overwrite = T ) ;
options()
openxlsx::options()
Willow.Harvest.Tables.wb<-createWorkbook() ;
Willow.Harvest.Tables.wb<-createWorkbook() ;
hs1<-createStyle(halign = "CENTER", textDecoration = "Bold", border = "Bottom", fontColour = "black")
options("openxlsx.borderStyle" = "thin")
options("openxlsx.borderColour" = "black")
options("openxlsx.headerStyle" = hs1)
options("openxlsx.withFilter" = F)
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_S1') ;
options("openxlsx.borderStyle" = "thin")
options("openxlsx.borderColour" = "black")
options("openxlsx.headerStyle" = hs1)
options("openxlsx.withFilter" = F)
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1, ) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1.coeff, startRow= dim(TS1)[1]+10) ;
saveWorkbook(Willow.Harvest.Tables.wb, file=paste0('../Tables', '.xlsx'), overwrite = T ) ;
hs1<-createStyle(halign = "CENTER", textDecoration = "bold", border = "Bottom", fontColour = "black")
Willow.Harvest.Tables.wb<-createWorkbook() ;
## Set excel table formatting parameters
#header style
hs1<-createStyle(halign = "CENTER", textDecoration = "bold", border = "Bottom", fontColour = "black")
# options("openxlsx.borderStyle" = "thin")
# options("openxlsx.borderColour" = "black")
# options("openxlsx.headerStyle" = hs1)
# options("openxlsx.withFilter" = F)
#### Table_S1
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_S1') ;
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_S1') ;
Willow.Harvest.Tables.wb<-createWorkbook() ;
hs1<-createStyle(halign = "CENTER", textDecoration = "bold", border = "Bottom", fontColour = "black")
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_S1') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1, ) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1.coeff, startRow= dim(TS1)[1]+10) ;
saveWorkbook(Willow.Harvest.Tables.wb, file=paste0('../Tables', '.xlsx'), overwrite = T ) ;
HeadersStyle<-createStyle(fontName="Times New Roman",fontSize = 12, halign = "CENTER", textDecoration = "bold", border = "Bottom", fontColour = "black")
illow.Harvest.Tables.wb<-createWorkbook() ;
## Set excel table formatting parameters
HeadersStyle<-createStyle(fontName="Times New Roman",fontSize = 12, halign = "CENTER", textDecoration = "bold", border = "Bottom", fontColour = "black") ;
CellStyle<-createStyle(fontName="Times New Roman",fontSize = 12, halign = "CENTER", textDecoration = NULL, fontColour = "black")
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_S1') ;
Willow.Harvest.Tables.wb<-createWorkbook() ;
HeadersStyle<-createStyle(fontName="Times New Roman",fontSize = 12, halign = "CENTER", textDecoration = "bold", border = "Bottom", fontColour = "black") ;
CellStyle<-createStyle(fontName="Times New Roman",fontSize = 12, halign = "CENTER", textDecoration = NULL, fontColour = "black")
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_S1') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1, headerStyle = HeadersStyle  ) ;
saveWorkbook(Willow.Harvest.Tables.wb, file=paste0('../Tables', '.xlsx'), overwrite = T ) ;
Willow.Harvest.Tables.wb<-createWorkbook() ;
HeadersStyle<-createStyle(fontName="Times New Roman",fontSize = 12, halign = "CENTER", textDecoration = "bold", border = "Bottom", fontColour = "black") ;
CellStyle<-createStyle(fontName="Times New Roman",fontSize = 12, halign = "CENTER", textDecoration = NULL, fontColour = "black")
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_S1') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1, headerStyle = HeadersStyle, fontName="Times New Roman",fontSize = 12, halign = "CENTER", textDecoration = NULL, fontColour = "black"  ) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1.coeff, startRow= dim(TS1)[1]+10) ;
Willow.Harvest.Tables.wb<-createWorkbook() ;
HeadersStyle<-createStyle(fontName="Times New Roman",fontSize = 12, halign = "CENTER", textDecoration = "bold", border = "Bottom", fontColour = "black") ;
CellStyle<-createStyle(fontName="Times New Roman",fontSize = 12, halign = "CENTER", textDecoration = NULL, fontColour = "black")
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_S1') ;
addStyle(Willow.Harvest.Tables.wb, CellStyle)
addStyle(Willow.Harvest.Tables.wb, style=CellStyle)
addStyle(Willow.Harvest.Tables.wb, sheet='Table_S1',style=CellStyle)
getOption("openxlsx.borderColour")
HeadersStyle<-createStyle(fontName="Times New Roman",fontSize = 12, halign = "CENTER", textDecoration = "bold", border = "Bottom", fontColour = "black") ;
options("openxlsx.fontName" = "Times New Roman");
options("openxlsx.fontColour" = "black");
options("openxlsx.fontSize" = 12);
options("openxlsx.halign" = "CENTER");
Willow.Harvest.Tables.wb<-createWorkbook() ;
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_S1') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1, headerStyle = HeadersStyle) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1.coeff, startRow= dim(TS1)[1]+10) ;
saveWorkbook(Willow.Harvest.Tables.wb, file=paste0('../Tables', '.xlsx'), overwrite = T ) ;
getOption("openxlsx.fontName")
getOption("openxlsx.fontSize")
CellStyle
CellStyle<-createStyle(fontName="Times New Roman",fontSize = 12, halign = "CENTER", fontColour='black') ;
Willow.Harvest.Tables.wb<-createWorkbook() ;
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_1') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1, headerStyle = HeadersStyle) ;
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_S1') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1, headerStyle = HeadersStyle) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1.coeff, startRow= dim(TS1)[1]+10) ;
addStyle(Willow.Harvest.Tables.wb, sheet='Table_S1', style=CellStyle, rows=seq(2,dim(TS1)[1]), cols=seq(1,dim(TS1)[2]) )
seq(2,dim(TS1)[1])
seq(1,dim(TS1)[2]
)
addStyle(Willow.Harvest.Tables.wb, sheet='Table_S1', style=CellStyle, rows=seq(2,dim(TS1)[1]), cols=seq(1,dim(TS1)[2]), gridExpand = TRUE )
saveWorkbook(Willow.Harvest.Tables.wb, file=paste0('../Tables', '.xlsx'), overwrite = T ) ;
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_S1') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1, headerStyle = HeadersStyle) ;
addStyle(Willow.Harvest.Tables.wb, sheet='Table_S1', style=CellStyle, rows=seq(2,dim(TS1)[1]), cols=seq(1,dim(TS1)[2]), gridExpand = TRUE )
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1.coeff, startRow= dim(TS1)[1]+10) ;
saveWorkbook(Willow.Harvest.Tables.wb, file=paste0('../Tables', '.xlsx'), overwrite = T ) ;
## Set excel table formatting parameters and create workbook
HeadersStyle<-createStyle(fontName="Times New Roman",fontSize = 12, halign = "CENTER", textDecoration = "bold", border = "Bottom", fontColour = "black") ;
CellStyle<-createStyle(fontName="Times New Roman",fontSize = 12, halign = "CENTER", fontColour='black') ;
Willow.Harvest.Tables.wb<-createWorkbook() ;
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_S1') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1, headerStyle = HeadersStyle) ;
addStyle(Willow.Harvest.Tables.wb, sheet='Table_S1', style=CellStyle, rows=seq(2,dim(TS1)[1]), cols=seq(1,dim(TS1)[2]), gridExpand = TRUE )
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1.coeff, startRow= dim(TS1)[1]+10) ;
saveWorkbook(Willow.Harvest.Tables.wb, file=paste0('../Tables', '.xlsx'), overwrite = T ) ;
dim(TS1)
HeadersStyle<-createStyle(fontName="Times New Roman",fontSize = 12, halign = "CENTER", textDecoration = "bold", border = "Bottom", fontColour = "black") ;
CellStyle<-createStyle(fontName="Times New Roman",fontSize = 12, halign = "CENTER", fontColour='black') ;
Willow.Harvest.Tables.wb<-createWorkbook() ;
#### Table_S1
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_S1') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1, headerStyle = HeadersStyle) ;
addStyle(Willow.Harvest.Tables.wb, sheet='Table_S1', style=CellStyle, rows=seq(2,dim(TS1)[1]+2), cols=seq(1,dim(TS1)[2]), gridExpand = TRUE );
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1.coeff, startRow= dim(TS1)[1]+10) ;
#### Table_1
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_1') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_1',x= T1 , headerStyle = HeadersStyle)  ;
addStyle(Willow.Harvest.Tables.wb, sheet='Table_1', style=CellStyle, rows=seq(2,dim(T1)[1]+2), cols=seq(1,dim(T1)[2]), gridExpand = TRUE ) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_1',x= T1.coeff, startRow= dim(T1)[1]+10) ;
#### Table_2
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_2') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_2',x= T2, headerStyle = HeadersStyle) ;
addStyle(Willow.Harvest.Tables.wb, sheet='Table_2', style=CellStyle, rows=seq(2,dim(T2)[1]+2), cols=seq(1,dim(T2)[2]), gridExpand = TRUE ) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_2',x= T2.coeff, startRow= dim(T2)[1]+10) ;
saveWorkbook(Willow.Harvest.Tables.wb, file=paste0('../Tables', '.xlsx'), overwrite = T ) ;
AnalysisHArvest.Plot.T3<-lm(MEAN_DRY.Mg.Ha.Year ~  MEAN_PLANT.DENSITY.pl.ha + (F.HARVEST.YEAR * F.VARIETY) + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY, data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',]);
summary(AnalysisHArvest.Plot.T3)
anova(AnalysisHArvest.Plot.T3, test="F")
T3<-tidy(anova(AnalysisHArvest.Plot.T3, test="F"))
tidy(anova(AnalysisHArvest.Plot.T3, test="F"))
AnalysisHArvest.Plot.T2<-lm(MEAN_DRY.Mg.Ha.Year ~  MEAN_PLANT.DENSITY.pl.ha + (F.HARVEST.YEAR * F.VARIETY) + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY, data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',]);
AnalysisHArvest.Plot.T2<-lm(MEAN_DRY.Mg.Ha.Year ~  MEAN_PLANT.DENSITY.pl.ha + (F.HARVEST.YEAR * F.VARIETY) + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY, data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',]);
summary(AnalysisHArvest.Plot.T2)
anova(AnalysisHArvest.Plot.T2, test="F")
T2<-tidy(anova(AnalysisHArvest.Plot.T2, test="F"))
T2.coeff<-tidy(AnalysisHArvest.Plot.T2)
Paper.data.Plots[which(Paper.data.Plots$F.SURVEY.YEAR==2014),]
AnalysisHArvest.Plot<-lm(MEAN_DRY.Mg.Ha.Year ~ F.HARVEST.YEAR * F.BLOCK * F.VARIETY  , data=Paper.data.Plots[which(Paper.data.Plots$F.SURVEY.YEAR==2014),]); ### Overfitted
AnalysisHArvest.Plot.TS1<-lm(MEAN_DRY.Mg.Ha.Year ~ F.HARVEST.YEAR * (F.BLOCK + F.VARIETY)  , data=Paper.data.Plots[which(Paper.data.Plots$F.SURVEY.YEAR==2014),]); ### Table S1
summary(AnalysisHArvest.Plot.TS1)
anova(AnalysisHArvest.Plot.TS1, test="F")
TS1<-tidy(anova(AnalysisHArvest.Plot.TS1, test="F"))
names(TS1)
TS1.coeff<-tidy(AnalysisHArvest.Plot.TS1)
AnalysisHArvest.Plot.T1<-lm(MEAN_DRY.Mg.Ha.Year ~ F.HARVEST.YEAR * F.VARIETY  , data=Paper.data.Plots[which(Paper.data.Plots$F.SURVEY.YEAR==2014),]);### Table 1
summary(AnalysisHArvest.Plot.T1)
anova(AnalysisHArvest.Plot.T1, test="F")
T1<-tidy(anova(AnalysisHArvest.Plot.T1, test="F"))
T1.coeff<-tidy(AnalysisHArvest.Plot.T1)
# ###############################################################################################################
# #                           Analysis using lm  and adding a dummy variable to include the survey year
# ###############################################################################################################
#
# # View(Paper.data.Plots)  ;  str(Paper.data.Plots)
#
# #  For three different cathegories, two dummy variables are needed to differentiate between them; [z1, z2] where z1={1, 0, 0} and z2={0, 1, 0}
# #  See Draper and Smith, 1998. Applied Regression Analysis
# #
#
# Paper.data.Plots$Z1<-Paper.data.Plots$Z2<-0 ;
#
# # Dummy variables for survey year 2013 = {z1=1, z2=0}
#
# Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2013", c("Z1")]<-1 ;
# Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2013", c("Z2")]<-0 ;
#
#
# # Dummy variables for survey year 2014 = {z1=0, z2=1}
#
# Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2014", c("Z1")]<-0 ;
# Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2014", c("Z2")]<-1 ;
#
#
#
# # Dummy variables for survey year 2015 = {z1=0, z2=0}
#
# Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == "2016", c("Z1","Z2")]<-0 ;
#
# ### Analysis with lm with survey year and the dummy variables z1 z2
#
#
# AnalysisHArvest.Plot.T2<-lm(MEAN_DRY.Mg.Ha.Year ~ Z1 + Z2 + ( F.HARVEST.YEAR * F.VARIETY * MEAN_PLANT.DENSITY.pl.ha) , data=Paper.data.Plots);
#
#
# summary(AnalysisHArvest.Plot.T2)
#
# anova(AnalysisHArvest.Plot.T2, test="F")
#
# T2<-tidy(anova(AnalysisHArvest.Plot.T2, test="F"))
#
# T2.coeff<-tidy(AnalysisHArvest.Plot.T2)
#
#
#####Analysis using only the population density of the 2016 survey
AnalysisHArvest.Plot.T2<-lm(MEAN_DRY.Mg.Ha.Year ~  MEAN_PLANT.DENSITY.pl.ha + (F.HARVEST.YEAR * F.VARIETY) + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY, data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',]);
summary(AnalysisHArvest.Plot.T2)
anova(AnalysisHArvest.Plot.T2, test="F")
T2<-tidy(anova(AnalysisHArvest.Plot.T2, test="F"))
T2.coeff<-tidy(AnalysisHArvest.Plot.T2)
HeadersStyle<-createStyle(fontName="Times New Roman",fontSize = 12, halign = "CENTER", textDecoration = "bold", border = "Bottom", fontColour = "black") ;
CellStyle<-createStyle(fontName="Times New Roman",fontSize = 12, halign = "CENTER", fontColour='black') ;
Willow.Harvest.Tables.wb<-createWorkbook() ;
#### Table_S1
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_S1') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1, headerStyle = HeadersStyle) ;
addStyle(Willow.Harvest.Tables.wb, sheet='Table_S1', style=CellStyle, rows=seq(2,dim(TS1)[1]+2), cols=seq(1,dim(TS1)[2]), gridExpand = TRUE );
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1.coeff, startRow= dim(TS1)[1]+10) ;
#### Table_1
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_1') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_1',x= T1 , headerStyle = HeadersStyle)  ;
addStyle(Willow.Harvest.Tables.wb, sheet='Table_1', style=CellStyle, rows=seq(2,dim(T1)[1]+2), cols=seq(1,dim(T1)[2]), gridExpand = TRUE ) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_1',x= T1.coeff, startRow= dim(T1)[1]+10) ;
#### Table_2
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_2') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_2',x= T2, headerStyle = HeadersStyle) ;
addStyle(Willow.Harvest.Tables.wb, sheet='Table_2', style=CellStyle, rows=seq(2,dim(T2)[1]+2), cols=seq(1,dim(T2)[2]), gridExpand = TRUE ) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_2',x= T2.coeff, startRow= dim(T2)[1]+10) ;
saveWorkbook(Willow.Harvest.Tables.wb, file=paste0('../Agronomy Journal/Tables', '.xlsx'), overwrite = T ) ;
AnalysisHArvest.Plot.T2<-lme(MEAN_DRY.Mg.Ha.Year ~  MEAN_PLANT.DENSITY.pl.ha + (F.HARVEST.YEAR * F.VARIETY) + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY, data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',] random = ~ MEAN_PLANT.DENSITY.pl.ha);
AnalysisHArvest.Plot.T2<-lme(MEAN_DRY.Mg.Ha.Year ~  MEAN_PLANT.DENSITY.pl.ha + (F.HARVEST.YEAR * F.VARIETY) + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY, data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',], random = ~ MEAN_PLANT.DENSITY.pl.ha);
library(nlme)
AnalysisHArvest.Plot.T2<-lme(MEAN_DRY.Mg.Ha.Year ~  MEAN_PLANT.DENSITY.pl.ha + (F.HARVEST.YEAR * F.VARIETY) + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY, data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',], random = ~ MEAN_PLANT.DENSITY.pl.ha);
AnalysisHArvest.Plot.T2<-lme(MEAN_DRY.Mg.Ha.Year ~  MEAN_PLANT.DENSITY.pl.ha + (F.HARVEST.YEAR * F.VARIETY) + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY, data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',], random = ~ MEAN_PLANT.DENSITY.pl.ha + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY/F.VARIETY );
AnalysisHArvest.Plot.T2<-lme(MEAN_DRY.Mg.Ha.Year ~  MEAN_PLANT.DENSITY.pl.ha + (F.HARVEST.YEAR * F.VARIETY) + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY, data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',], random = ~ MEAN_PLANT.DENSITY.pl.ha + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY |F.VARIETY );
AnalysisHArvest.Plot.T2<-lme(MEAN_DRY.Mg.Ha.Year ~  MEAN_PLANT.DENSITY.pl.ha + (F.HARVEST.YEAR * F.VARIETY) + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY, data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',], random = ~ MEAN_PLANT.DENSITY.pl.ha|F.VARIETY );
summary(AnalysisHArvest.Plot.T2)
anova(AnalysisHArvest.Plot.T2, test="F")
anova(AnalysisHArvest.Plot.T2)
AnalysisHArvest.Plot.T2<-lme(MEAN_DRY.Mg.Ha.Year ~  MEAN_PLANT.DENSITY.pl.ha + (F.HARVEST.YEAR * F.VARIETY) + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY, data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',], random = ~ MEAN_PLANT.DENSITY.pl.ha );
AnalysisHArvest.Plot.T2<-lme(MEAN_DRY.Mg.Ha.Year ~  MEAN_PLANT.DENSITY.pl.ha + (F.HARVEST.YEAR * F.VARIETY) + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY, data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',], random = ~ MEAN_PLANT.DENSITY.pl.ha + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY | F.VARIETY);
AnalysisHArvest.Plot.T2<-lme(MEAN_DRY.Mg.Ha.Year ~  MEAN_PLANT.DENSITY.pl.ha + (F.HARVEST.YEAR * F.VARIETY) + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY, data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',], random = ~ MEAN_PLANT.DENSITY.pl.ha | F.VARIETY);
summary(AnalysisHArvest.Plot.T2)
anova(AnalysisHArvest.Plot.T2)
AnalysisHArvest.Plot.T2<-lme(MEAN_DRY.Mg.Ha.Year ~  MEAN_PLANT.DENSITY.pl.ha + (F.HARVEST.YEAR * F.VARIETY) + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY, data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',], random = ~ MEAN_PLANT.DENSITY.pl.ha | MEAN_PLANT.DENSITY.pl.ha * F.VARIETY);
AnalysisHArvest.Plot.T2<-lme(MEAN_DRY.Mg.Ha.Year ~  MEAN_PLANT.DENSITY.pl.ha + (F.HARVEST.YEAR * F.VARIETY) + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY, data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',], random = ~ MEAN_PLANT.DENSITY.pl.ha | 1);
AnalysisHArvest.Plot.T2<-lme(MEAN_DRY.Mg.Ha.Year ~  MEAN_PLANT.DENSITY.pl.ha + (F.HARVEST.YEAR * F.VARIETY) + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY, data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',], random = ~ MEAN_PLANT.DENSITY.pl.ha | F.VARIETY);
summary(AnalysisHArvest.Plot.T2)
anova(AnalysisHArvest.Plot.T2)
T2<-tidy(anova(AnalysisHArvest.Plot.T2)
T2<-tidy(anova(AnalysisHArvest.Plot.T2))
T2.coeff<-tidy(AnalysisHArvest.Plot.T2)
anova(AnalysisHArvest.Plot.T2)
AnalysisHArvest.Plot.T2<-lme(MEAN_DRY.Mg.Ha.Year ~  MEAN_PLANT.DENSITY.pl.ha + (F.HARVEST.YEAR * F.VARIETY) + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY, data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',], random = ~ MEAN_PLANT.DENSITY.pl.ha |(F.HARVEST.YEAR * F.VARIETY));
AnalysisHArvest.Plot.T2<-lme(MEAN_DRY.Mg.Ha.Year ~  MEAN_PLANT.DENSITY.pl.ha + (F.HARVEST.YEAR * F.VARIETY) + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY, data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',], random = ~ MEAN_PLANT.DENSITY.pl.ha |F.HARVEST.YEAR / F.VARIETY);
summary(AnalysisHArvest.Plot.T2)
anova(AnalysisHArvest.Plot.T2)
AnalysisHArvest.Plot.T2<-lme(MEAN_DRY.Mg.Ha.Year ~  MEAN_PLANT.DENSITY.pl.ha + (F.HARVEST.YEAR * F.VARIETY) + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY, data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',], random = ~ MEAN_PLANT.DENSITY.pl.ha | F.VARIETY);
AnalysisHArvest.Plot.T2<-lme(MEAN_DRY.Mg.Ha.Year ~  MEAN_PLANT.DENSITY.pl.ha + (F.HARVEST.YEAR * F.VARIETY) + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY, data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',], random = ~ MEAN_PLANT.DENSITY.pl.ha | F.VARIETY, method = "ML");
summary(AnalysisHArvest.Plot.T2)
anova(AnalysisHArvest.Plot.T2)
T2<-tidy(anova(AnalysisHArvest.Plot.T2))
T2.coeff<-tidy(AnalysisHArvest.Plot.T2)
## Set excel table formatting parameters and create workbook
HeadersStyle<-createStyle(fontName="Times New Roman",fontSize = 12, halign = "CENTER", textDecoration = "bold", border = "Bottom", fontColour = "black") ;
CellStyle<-createStyle(fontName="Times New Roman",fontSize = 12, halign = "CENTER", fontColour='black') ;
Willow.Harvest.Tables.wb<-createWorkbook() ;
#### Table_S1
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_S1') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1, headerStyle = HeadersStyle) ;
addStyle(Willow.Harvest.Tables.wb, sheet='Table_S1', style=CellStyle, rows=seq(2,dim(TS1)[1]+2), cols=seq(1,dim(TS1)[2]), gridExpand = TRUE );
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1.coeff, startRow= dim(TS1)[1]+10) ;
#### Table_1
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_1') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_1',x= T1 , headerStyle = HeadersStyle)  ;
addStyle(Willow.Harvest.Tables.wb, sheet='Table_1', style=CellStyle, rows=seq(2,dim(T1)[1]+2), cols=seq(1,dim(T1)[2]), gridExpand = TRUE ) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_1',x= T1.coeff, startRow= dim(T1)[1]+10) ;
#### Table_2
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_2') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_2',x= T2, headerStyle = HeadersStyle) ;
addStyle(Willow.Harvest.Tables.wb, sheet='Table_2', style=CellStyle, rows=seq(2,dim(T2)[1]+2), cols=seq(1,dim(T2)[2]), gridExpand = TRUE ) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_2',x= T2.coeff, startRow= dim(T2)[1]+10) ;
saveWorkbook(Willow.Harvest.Tables.wb, file=paste0('../Agronomy Journal/Tables', '.xlsx'), overwrite = T ) ;
summary(AnalysisHArvest.Plot.T2)
T2<-tidy(summary(AnalysisHArvest.Plot.T2))
summary(AnalysisHArvest.Plot.T2)
anova(AnalysisHArvest.Plot.T2)
T2<-tidy(anova(AnalysisHArvest.Plot.T2))
tidy(anova(AnalysisHArvest.Plot.T2))
T2<-anova(AnalysisHArvest.Plot.T2)
tidy(AnalysisHArvest.Plot.T2)
HeadersStyle<-createStyle(fontName="Times New Roman",fontSize = 12, halign = "CENTER", textDecoration = "bold", border = "Bottom", fontColour = "black") ;
CellStyle<-createStyle(fontName="Times New Roman",fontSize = 12, halign = "CENTER", fontColour='black') ;
Willow.Harvest.Tables.wb<-createWorkbook() ;
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_S1') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1, headerStyle = HeadersStyle) ;
addStyle(Willow.Harvest.Tables.wb, sheet='Table_S1', style=CellStyle, rows=seq(2,dim(TS1)[1]+2), cols=seq(1,dim(TS1)[2]), gridExpand = TRUE );
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1.coeff, startRow= dim(TS1)[1]+10) ;
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_1') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_1',x= T1 , headerStyle = HeadersStyle)  ;
addStyle(Willow.Harvest.Tables.wb, sheet='Table_1', style=CellStyle, rows=seq(2,dim(T1)[1]+2), cols=seq(1,dim(T1)[2]), gridExpand = TRUE ) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_1',x= T1.coeff, startRow= dim(T1)[1]+10) ;
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_2') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_2',x= T2, headerStyle = HeadersStyle) ;
addStyle(Willow.Harvest.Tables.wb, sheet='Table_2', style=CellStyle, rows=seq(2,dim(T2)[1]+2), cols=seq(1,dim(T2)[2]), gridExpand = TRUE ) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_2',x= T2.coeff, startRow= dim(T2)[1]+10) ;
saveWorkbook(Willow.Harvest.Tables.wb, file=paste0('../Agronomy Journal/Tables', '.xlsx'), overwrite = T ) ;
T2
AnalysisHArvest.Plot.T2<-lme(MEAN_DRY.Mg.Ha.Year ~  MEAN_PLANT.DENSITY.pl.ha + (F.HARVEST.YEAR * F.VARIETY) + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY, data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',], random = ~ MEAN_PLANT.DENSITY.pl.ha | F.VARIETY, method = "ML");
summary(AnalysisHArvest.Plot.T2)
anova(AnalysisHArvest.Plot.T2)
T2<-anova(AnalysisHArvest.Plot.T2)
T2.coeff<-tidy(AnalysisHArvest.Plot.T2)
T2
T2.coeff<-tidy(AnalysisHArvest.Plot.T2)
## Set excel table formatting parameters and create workbook
HeadersStyle<-createStyle(fontName="Times New Roman",fontSize = 12, halign = "CENTER", textDecoration = "bold", border = "Bottom", fontColour = "black") ;
CellStyle<-createStyle(fontName="Times New Roman",fontSize = 12, halign = "CENTER", fontColour='black') ;
Willow.Harvest.Tables.wb<-createWorkbook() ;
#### Table_S1
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_S1') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1, headerStyle = HeadersStyle) ;
addStyle(Willow.Harvest.Tables.wb, sheet='Table_S1', style=CellStyle, rows=seq(2,dim(TS1)[1]+2), cols=seq(1,dim(TS1)[2]), gridExpand = TRUE );
writeData(Willow.Harvest.Tables.wb, sheet='Table_S1',x= TS1.coeff, startRow= dim(TS1)[1]+10) ;
#### Table_1
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_1') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_1',x= T1 , headerStyle = HeadersStyle)  ;
addStyle(Willow.Harvest.Tables.wb, sheet='Table_1', style=CellStyle, rows=seq(2,dim(T1)[1]+2), cols=seq(1,dim(T1)[2]), gridExpand = TRUE ) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_1',x= T1.coeff, startRow= dim(T1)[1]+10) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_2',x= T2, headerStyle = HeadersStyle, rowNames = T) ;
addWorksheet(Willow.Harvest.Tables.wb, sheetName='Table_2') ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_2',x= T2, headerStyle = HeadersStyle, rowNames = T) ;
addStyle(Willow.Harvest.Tables.wb, sheet='Table_2', style=CellStyle, rows=seq(2,dim(T2)[1]+2), cols=seq(1,dim(T2)[2]), gridExpand = TRUE ) ;
writeData(Willow.Harvest.Tables.wb, sheet='Table_2',x= T2.coeff, startRow= dim(T2)[1]+10) ;
saveWorkbook(Willow.Harvest.Tables.wb, file=paste0('../Agronomy Journal/Tables', '.xlsx'), overwrite = T ) ;
Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',]
AnalysisHArvest.Plot.T2<-lme(MEAN_DRY.Mg.Ha.Year ~  F.BLOCK + MEAN_PLANT.DENSITY.pl.ha + (F.HARVEST.YEAR * F.VARIETY) + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY, data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',], random = ~ MEAN_PLANT.DENSITY.pl.ha | F.BLOCK, method = "ML");
AnalysisHArvest.Plot.T2<-lme(MEAN_DRY.Mg.Ha.Year ~  F.BLOCK + MEAN_PLANT.DENSITY.pl.ha + (F.HARVEST.YEAR * F.VARIETY) + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY, data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',], random = ~ MEAN_PLANT.DENSITY.pl.ha | F.BLOCK);
AnalysisHArvest.Plot.T2<-lme(MEAN_DRY.Mg.Ha.Year ~  MEAN_PLANT.DENSITY.pl.ha + (F.HARVEST.YEAR * F.VARIETY) + MEAN_PLANT.DENSITY.pl.ha * F.VARIETY, data=Paper.data.Plots[Paper.data.Plots$F.SURVEY.YEAR == '2016',], random = ~ MEAN_PLANT.DENSITY.pl.ha | F.VARIETY);
summary(AnalysisHArvest.Plot.T2)
anova(AnalysisHArvest.Plot.T2)
T2<-anova(AnalysisHArvest.Plot.T2)
T2.coeff<-tidy(AnalysisHArvest.Plot.T2)
